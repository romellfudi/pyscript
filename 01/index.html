<html>

<head>
  <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
  <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  <py-env>
    - numpy
    - matplotlib
    - networkx
  </py-env>
</head>

<body>
  <h1>Let's plot random numbers</h1>
  <div id="plot"></div>
  <py-script output="plot">
    import matplotlib.pyplot as plt
    import numpy as np

    x = np.random.randn(1000)
    y = np.random.randn(1000)

    fig, ax = plt.subplots()
    ax.scatter(x, y)
    fig
  </py-script>
  <div id="plot"></div>
  <py-script output="plot">
    import matplotlib.pyplot as plt
    import numpy as np

    np.random.seed(42)
    rv = np.random.standard_normal(1000)

    fig, ax = plt.subplots()
    ax.hist(rv, bins=30)
    fig
  </py-script>
  <py-script>
    import numpy as np
    import networkx as nx
  </py-script>

  <p>Message passing with linear algebra: a demo.</p>
  <p>Imagine we have a chain graph that looks like this:</p>
  <pre><code>O --> 1 --> 2 --> 3</code></pre>
  <p>In NetworkX this graph would look like the following:</p>
  <pre>
        <py-script>
G = nx.Graph()
nodes = list(range(4))
G.add_edges_from(zip(nodes[0:-1], nodes[1:]))
print("Edges:"G.edges())

import matplotlib.pyplot as plt

subax1 = plt.subplot(121)
nx.draw(G, with_labels=True, font_weight='bold')
subax2 = plt.subplot(122)
nx.draw_shell(G, nlist=[range(5, 10), range(5)], with_labels=True, font_weight='bold')
</py-script></pre>
  <p>This chain graph has the following adjacency matrix:</p>
  <pre>
<py-script>
adj_mat = np.eye(4, k=1)
print(f"A: {adj_mat}")
</py-script>
        </pre>
  <p>And imagine that we have a message that lives on the graph:</p>
  <pre>
    <py-script>
message = np.array([1.0, 0.0, 0.0, 0.0])
print(f"message: {message}")
    </py-script>
  </pre>
  <div>
    <py-repl id="my-repl" auto-generate="true"> </py-repl>
  </div>
</body>

</html>